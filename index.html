
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chery Arta - Modern Service Booking</title>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <style>
        :root {
            --chery-blue: #1e3a8a;
            --chery-red: #dc2626;
            --chery-gold: #fbbf24;
            --chery-white: #ffffff;
            --chery-gray: #f8fafc;
            --chery-dark: #1e293b;
            --shadow-light: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-medium: 0 10px 25px -3px rgba(0, 0, 0, 0.1);
            --shadow-heavy: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            --gradient-primary: linear-gradient(135deg, var(--chery-blue) 0%, var(--chery-red) 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: var(--chery-dark);
            overflow-x: hidden;
        }

        html {
            scroll-behavior: smooth;
        }

        .status-badge {
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
            white-space: nowrap;
        }

        .status-successful {
            background: #dcfce7;
            color: #166534;
        }

        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }

        .status-cancelled {
            background: #fee2e2;
            color: #991b1b;
        }

        .status-in-progress {
            background: #dbeafe;
            color: #1e40af;
        }

        .status-completed {
            background: #e0e7ff;
            color: #3730a3;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: 1rem 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .header.scrolled {
            padding: 0.5rem 0;
            box-shadow: var(--shadow-medium);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 800;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 1.5rem;
        }

        .nav-link {
            text-decoration: none;
            color: var(--chery-dark);
            font-weight: 500;
            position: relative;
            transition: all 0.3s ease;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            cursor: pointer;
        }

        .nav-link:hover {
            color: var(--chery-blue);
            background: rgba(30, 58, 138, 0.1);
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--chery-dark);
            cursor: pointer;
            padding: 0.5rem;
            transition: all 0.3s ease;
        }

        .mobile-menu-btn:hover {
            color: var(--chery-blue);
        }

        .mobile-menu {
            display: none;
            position: fixed;
            top: 70px;
            left: 0;
            right: 0;
            background: white;
            box-shadow: var(--shadow-heavy);
            z-index: 999;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .mobile-menu.show {
            display: block;
            max-height: 500px;
        }

        .mobile-menu ul {
            list-style: none;
            padding: 1rem;
        }

        .mobile-menu ul li {
            margin: 0;
        }

        .mobile-menu ul li a {
            display: block;
            padding: 1rem;
            color: var(--chery-dark);
            text-decoration: none;
            font-weight: 500;
            border-bottom: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .mobile-menu ul li a:hover {
            background: rgba(30, 58, 138, 0.1);
            color: var(--chery-blue);
            padding-left: 1.5rem;
        }

        .hero {
            min-height: 100vh;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
            padding-top: 5rem;
        }

        .hero-container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
            position: relative;
            z-index: 2;
        }

        .hero-content h1 {
            font-size: 3.5rem;
            font-weight: 800;
            color: var(--chery-white);
            margin-bottom: 1.5rem;
            line-height: 1.2;
        }

        .hero-content p {
            font-size: 1.25rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 2rem;
        }

        .hero-cta {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            background: var(--chery-gold);
            color: var(--chery-dark);
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-medium);
        }

        .hero-cta:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-heavy);
            background: #fcd34d;
        }

        .hero-image {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .hero-car {
            width: 100%;
            max-width: 500px;
            height: auto;
            filter: drop-shadow(0 20px 40px rgba(0, 0, 0, 0.3));
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        .facilities {
            padding: 5rem 0;
            background: var(--chery-gray);
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--chery-dark);
            margin-bottom: 3rem;
        }

        .facilities-slider {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            position: relative;
        }

        .slider-container {
            overflow: hidden;
            border-radius: 20px;
            box-shadow: var(--shadow-heavy);
        }

        .slider-track {
            display: flex;
            transition: transform 0.5s ease;
        }

        .facility-card {
            min-width: 100%;
            position: relative;
            height: 500px;
            border-radius: 20px;
            overflow: hidden;
            cursor: pointer;
        }

        .facility-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(0deg, rgba(0, 0, 0, 0.6) 0%, rgba(0, 0, 0, 0.2) 50%, rgba(0, 0, 0, 0.1) 100%);
            z-index: 2;
        }

        .facility-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .facility-card:hover .facility-image {
            transform: scale(1.05);
        }

        .facility-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 2rem;
            color: var(--chery-white);
            z-index: 3;
        }

        .facility-caption h3 {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
        }

        .slider-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .slider-btn {
            width: 50px;
            height: 50px;
            border: none;
            background: var(--chery-white);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-light);
            color: var(--chery-blue);
            font-size: 1.2rem;
        }

        .slider-btn:hover {
            background: var(--chery-blue);
            color: var(--chery-white);
            transform: scale(1.1);
        }

        .slider-indicators {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1.5rem;
        }

        .indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(30, 58, 138, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .indicator.active {
            background: var(--chery-blue);
            transform: scale(1.3);
        }

        .booking {
            padding: 5rem 0;
            background: var(--gradient-primary);
            position: relative;
        }

        .booking-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .booking-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 3rem;
            box-shadow: var(--shadow-heavy);
        }

        .booking-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--chery-white);
            margin-bottom: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
            position: relative;
        }

        .form-label {
            display: block;
            color: var(--chery-white);
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .form-input, select {
            width: 100%;
            padding: 1rem 1rem 1rem 3rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--chery-white);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        select option {
            background-color: var(--chery-blue);
            color: white;
        }

        select option {
            background-color: white;
            color: #1e293b;
            padding: 0.5rem;
            white-space: normal;
            line-height: 1.4;
        }

        select optgroup {
            background-color: #1e3a8a;
            color: white;
            font-weight: 600;
            padding: 0.5rem;
        }

        select {
            white-space: normal;
            height: auto;
        }

        .custom-select-wrapper {
            position: relative;
            width: 100%;
        }

        .custom-select {
            position: relative;
            cursor: pointer;
        }

        .custom-select-trigger {
            width: 100%;
            padding: 1rem 1rem 1rem 3rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--chery-white);
            font-size: 1rem;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .custom-select-trigger::after {
            content: '\f078';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            margin-left: 0.5rem;
            transition: transform 0.3s ease;
        }

        .custom-select.open .custom-select-trigger::after {
            transform: rotate(180deg);
        }

        .custom-select-trigger:hover,
        .custom-select.open .custom-select-trigger {
            border-color: var(--chery-gold);
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .custom-options {
            position: absolute;
            top: calc(100% + 0.5rem);
            left: 0;
            right: 0;
            background: #1e3a8a;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            max-height: 400px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            padding: 0.5rem;
        }

        .custom-select.open .custom-options {
            display: block;
        }

        .custom-optgroup {
            padding: 0.75rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-weight: 700;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin: 0.25rem 0;
            border-radius: 8px;
        }

        .custom-option {
            padding: 0.75rem 1rem;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 8px;
            margin: 0.25rem 0;
            white-space: normal;
            line-height: 1.5;
            word-wrap: break-word;
        }

        .custom-option:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .custom-option.selected {
            background: rgba(251, 191, 36, 0.3);
            font-weight: 600;
        }

        .custom-select-wrapper .form-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.1rem;
            z-index: 5;
            pointer-events: none;
        }

        .image-preview-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            z-index: 3000;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .image-preview-modal.show {
            display: flex;
        }

        .image-preview-content {
            position: relative;
            max-width: 90vw;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .image-preview-img {
            max-width: 100%;
            max-height: 80vh;
            object-fit: contain;
            border-radius: 15px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
        }

        .image-preview-caption {
            margin-top: 1.5rem;
            color: white;
            text-align: center;
        }

        .image-preview-caption h3 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .image-preview-caption p {
            font-size: 1rem;
            opacity: 0.9;
        }

        .image-preview-close {
            position: absolute;
            top: -3rem;
            right: 0;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image-preview-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .image-preview-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image-preview-nav:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .image-preview-prev {
            left: -5rem;
        }

        .image-preview-next {
            right: -5rem;
        }

        .facility-card {
            cursor: pointer;
        }

        .form-input:focus, select:focus {
            outline: none;
            border-color: var(--chery-gold);
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .plat-nomor-container {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .plat-input {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            padding: 1rem 0.5rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--chery-white);
            transition: all 0.3s ease;
        }

        .plat-input:focus {
            outline: none;
            border-color: var(--chery-gold);
            background: rgba(255, 255, 255, 0.15);
        }

        .plat-part-a { 
            width: 60px;
            text-transform: uppercase;
        }
        .plat-part-b { 
            width: 90px;
            text-align: center;
        }
        .plat-part-c { 
            width: 80px;
            text-transform: uppercase;
        }

        .separator {
            font-size: 20px;
            color: var(--chery-white);
        }

        .form-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.1rem;
            z-index: 1;
        }

        .submit-btn {
            width: 100%;
            padding: 1.25rem;
            background: var(--chery-gold);
            color: var(--chery-dark);
            border: none;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .submit-btn:hover {
            background: #fcd34d;
            transform: translateY(-2px);
        }

        .about {
            padding: 5rem 0;
            background: var(--chery-white);
        }

        .about-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
        }

        .about-content h2 {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--chery-dark);
            margin-bottom: 1.5rem;
        }

        .about-content p {
            font-size: 1.1rem;
            color: #64748b;
            margin-bottom: 1.5rem;
        }

        .about-features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background: var(--chery-gray);
            border-radius: 10px;
        }

        .feature-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--chery-white);
        }

        .contact {
            padding: 5rem 0;
            background: var(--chery-gray);
        }

        .contact-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .contact-card {
            background: var(--chery-white);
            padding: 2rem;
            border-radius: 20px;
            box-shadow: var(--shadow-light);
            text-align: center;
            transition: all 0.3s ease;
        }

        .contact-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }

        .contact-icon {
            width: 60px;
            height: 60px;
            background: var(--gradient-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--chery-white);
            margin: 0 auto 1rem;
            font-size: 1.5rem;
        }

        .admin-panel {
            padding: 5rem 0;
            background: var(--chery-white);
            display: none;
        }

        .admin-panel.show {
            display: block;
        }

        .admin-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .admin-header {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            gap: 1rem;
        }

        .admin-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--chery-dark);
        }

        .admin-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .admin-btn {
            padding: 0.6rem 1rem;
            border: none;
            border-radius: 10px;
            font-weight: 500;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap;
        }

        .export-btn {
            background: #22c55e;
            color: white;
        }

        .logout-btn {
            background: var(--chery-red);
            color: white;
        }

        /* MOBILE RESPONSIVE TABLE */
        .table-wrapper {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow-light);
            min-width: 800px;
        }

        .table th {
            background: var(--chery-blue);
            color: white;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            white-space: nowrap;
        }

        .table td {
            padding: 1rem;
            border-bottom: 1px solid #e2e8f0;
            word-wrap: break-word;
        }

        /* CARD VIEW FOR MOBILE */
        .mobile-card-view {
            display: none;
        }

        .booking-card-mobile {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow-light);
        }

        .card-header-mobile {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e2e8f0;
        }

        .card-name-mobile {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--chery-dark);
        }

        .card-date-mobile {
            font-size: 0.85rem;
            color: #64748b;
            margin-top: 0.25rem;
        }

        .card-body-mobile {
            display: grid;
            gap: 0.75rem;
        }

        .card-row-mobile {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-label-mobile {
            font-size: 0.85rem;
            color: #64748b;
            font-weight: 500;
        }

        .card-value-mobile {
            font-size: 0.9rem;
            color: var(--chery-dark);
            font-weight: 600;
            text-align: right;
        }

        .card-actions-mobile {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
        }

        .action-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 0.25rem;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.875rem;
        }

        .edit-btn {
            background: #3b82f6;
            color: white;
        }

        .edit-btn:hover {
            background: #2563eb;
        }

        .delete-btn {
            background: var(--chery-red);
            color: white;
        }

        .delete-btn:hover {
            background: #b91c1c;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 20px;
            width: 90%;
            max-width: 400px;
            box-shadow: var(--shadow-heavy);
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            text-align: center;
            margin-bottom: 1.5rem;
            color: var(--chery-dark);
        }

        .modal-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            margin-bottom: 1rem;
            font-size: 1rem;
        }

        .modal-input:focus {
            outline: none;
            border-color: var(--chery-blue);
        }

        .modal-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--chery-dark);
            font-size: 0.875rem;
        }

        .modal-btn {
            width: 100%;
            padding: 0.75rem;
            background: var(--chery-blue);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-btn:hover {
            background: #1e40af;
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #64748b;
        }

        .service-panel {
            padding: 6rem 0;
            background: var(--chery-gray);
            display: none;
        }

        .service-panel.show {
            display: block;
        }

        .service-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .service-search {
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .search-input {
            width: 100%;
            max-width: 400px;
            padding: 0.75rem 1rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }

        .search-btn {
            background: var(--chery-blue);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            cursor: pointer;
        }

        .service-actions {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .service-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }

        .back-btn {
            background: #e5e7eb;
            color: #374151;
        }

        .footer {
            padding: 3rem 0 1rem;
            background: var(--chery-dark);
            color: white;
            text-align: center;
        }

        /* MEDIA QUERIES */
        @media (max-width: 1024px) {
            .hero-content h1 {
                font-size: 2.5rem;
            }

            .logo {
                font-size: 1.3rem;
            }

            .nav-menu {
                gap: 1rem;
            }

            .nav-link {
                padding: 0.4rem 0.8rem;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }

            .mobile-menu-btn {
                display: block;
            }

            .hero-container {
                grid-template-columns: 1fr;
                gap: 2rem;
                padding: 0 1rem;
            }

            .hero {
                padding-top: 4rem;
            }

            .hero-content h1 {
                font-size: 2rem;
            }

            .hero-content p {
                font-size: 1rem;
            }

            .about-container {
                grid-template-columns: 1fr;
            }

            .section-title {
                font-size: 2rem;
            }

            .booking-card {
                padding: 2rem 1.5rem;
            }

            .booking-title {
                font-size: 1.8rem;
            }

            .facilities-slider {
                padding: 0 1rem;
            }

            .facility-card {
                height: 400px;
            }

            .facility-caption h3 {
                font-size: 1.3rem;
            }

            .about-content h2 {
                font-size: 2rem;
            }

            .about-features {
                grid-template-columns: 1fr;
            }

            /* HIDE TABLE, SHOW CARDS ON MOBILE */
            .table-wrapper {
                display: none !important;
            }

            .mobile-card-view {
                display: block;
            }

            .admin-title {
                font-size: 1.3rem;
            }

            .admin-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .admin-actions {
                width: 100%;
                justify-content: flex-start;
            }

            .admin-btn {
                flex: 1;
                min-width: 0;
                justify-content: center;
                font-size: 0.8rem;
                padding: 0.5rem 0.75rem;
            }

            .admin-btn i {
                font-size: 0.9rem;
            }

            .admin-filters > div:first-child {
                grid-template-columns: 1fr !important;
            }

            .image-preview-nav {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }

            .image-preview-prev {
                left: 0.5rem;
            }

            .image-preview-next {
                right: 0.5rem;
            }

            .image-preview-close {
                top: 0.5rem;
                right: 0.5rem;
            }
        }

        @media (max-width: 480px) {
            .plat-nomor-container {
                gap: 3px;
            }

            .plat-input {
                font-size: 14px;
                padding: 0.75rem 0.3rem;
            }

            .plat-part-a { width: 50px; }
            .plat-part-b { width: 70px; }
            .plat-part-c { width: 60px; }

            .separator {
                font-size: 16px;
            }

            .hero-content h1 {
                font-size: 1.6rem;
            }

            .booking-title {
                font-size: 1.5rem;
            }

            .section-title {
                font-size: 1.6rem;
            }

            .modal-content {
                padding: 1.5rem;
            }

            .contact-container {
                grid-template-columns: 1fr;
            }

            .admin-actions {
                flex-direction: column;
            }

            .admin-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <header class="header" id="header">
        <div class="nav-container">
            <div class="logo">Chery Arta</div>
            <nav>
                <ul class="nav-menu">
                    <li><a href="#home" class="nav-link" onclick="goToHome()">Home</a></li>
                    <li><a href="#facilities" class="nav-link">Fasilitas</a></li>
                    <li><a href="#booking" class="nav-link">Book Service</a></li>
                    <li><a class="nav-link" onclick="showCekService()">Cek Service</a></li>
                    <li><a href="#about" class="nav-link">Tentang</a></li>
                    <li><a href="#contact" class="nav-link">Contact</a></li>
                    <li><a class="nav-link" onclick="showAdminLogin()">Admin</a></li>
                </ul>
                <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                    <i class="fas fa-bars"></i>
                </button>
            </nav>
        </div>
        <div class="mobile-menu" id="mobileMenu">
            <ul>
                <li><a href="#home" onclick="goToHome(); closeMobileMenu()">
                    <i class="fas fa-home"></i> Home
                </a></li>
                <li><a href="#facilities" onclick="closeMobileMenu()">
                    <i class="fas fa-building"></i> Fasilitas
                </a></li>
                <li><a href="#booking" onclick="closeMobileMenu()">
                    <i class="fas fa-calendar-alt"></i> Book Service
                </a></li>
                <li><a onclick="showCekService(); closeMobileMenu()">
                    <i class="fas fa-search"></i> Cek Service
                </a></li>
                <li><a href="#about" onclick="closeMobileMenu()">
                    <i class="fas fa-info-circle"></i> Tentang
                </a></li>
                <li><a href="#contact" onclick="closeMobileMenu()">
                    <i class="fas fa-phone"></i> Contact
                </a></li>
                <li><a onclick="showAdminLogin(); closeMobileMenu()">
                    <i class="fas fa-user-shield"></i> Admin
                </a></li>
            </ul>
        </div>
    </header>

    <section class="hero" id="home">
        <div class="hero-container">
            <div class="hero-content">
                <h1>Book Your Chery Arta Service Today</h1>
                <p>Experience premium automotive service with expert maintenance solutions</p>
                <a href="#booking" class="hero-cta">
                    <i class="fas fa-calendar-alt"></i>
                    Book Now
                </a>
            </div>
            <div class="hero-image">
                <img src="https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/pngwing.com%20(2).png" alt="Chery Car" class="hero-car">
            </div>
        </div>
    </section>

    <section class="facilities" id="facilities">
        <div class="facilities-slider">
            <h2 class="section-title">Fasilitas Kami</h2>
            <div class="slider-container">
                <div class="slider-track" id="sliderTrack">
                    <div class="facility-card" onclick="openImagePreview(0)">
                        <img src="https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/frontside.webp" alt="Ruang Tunggu" class="facility-image">
                        <div class="facility-caption">
                            <h3>Customer Service Center</h3>
                            <p>Meja pelayanan customer service yang profesional</p>
                        </div>
                    </div>
                    <div class="facility-card" onclick="openImagePreview(1)">
                        <img src="https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/IMG-20250919-WA0014.jpg" alt="Ruang Meeting" class="facility-image">
                        <div class="facility-caption">
                            <h3>Showroom Chery</h3>
                            <p>Showroom eksklusif menampilkan koleksi lengkap kendaraan Chery</p>
                        </div>
                    </div>
                    <div class="facility-card" onclick="openImagePreview(2)">
                        <img src="https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/IMG-20250919-WA0015.jpg" alt="Area Diskusi" class="facility-image">
                        <div class="facility-caption">
                            <h3>Ruang Tunggu Premium</h3>
                            <p>Ruang tunggu eksklusif dengan sofa nyaman dan mural pemandangan pegunungan</p>
                        </div>
                    </div>
                    <div class="facility-card" onclick="openImagePreview(3)">
                        <img src="https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/IMG-20250919-WA0019.jpg" alt="Customer Service" class="facility-image">
                        <div class="facility-caption">
                            <h3>Kids Play Area</h3>
                            <p>Area bermain anak yang aman dan menyenangkan</p>
                        </div>
                    </div>
                    <div class="facility-card" onclick="openImagePreview(4)">
                        <img src="https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/IMG-20250919-WA0018.jpg" alt="Playground" class="facility-image">
                        <div class="facility-caption">
                            <h3>Workshop Modern</h3>
                            <p>Bengkel dengan teknologi terdepan dan peralatan canggih</p>
                        </div>
                    </div>
                    <div class="facility-card" onclick="openImagePreview(5)">
                        <img src="https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/fasilitas2.webp" alt="Workshop" class="facility-image">
                        <div class="facility-caption">
                            <h3>Area Diskusi Santai</h3>
                            <p>Area santai dengan meja bulat yang nyaman untuk berdiskusi dengan keluarga</p>
                        </div>
                    </div>
                    <div class="facility-card" onclick="openImagePreview(6)">
                        <img src="https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/fasilitas3.webp" alt="Showroom" class="facility-image">
                        <div class="facility-caption">
                            <h3>Ruang Konsultasi</h3>
                            <p>Ruang meeting modern untuk diskusi dan konsultasi mengenai perawatan kendaraan</p>
                        </div>
                    </div>
                    <div class="facility-card" onclick="openImagePreview(7)">
                        <img src="https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/fasilitas4.webp" alt="Lounge" class="facility-image">
                        <div class="facility-caption">
                            <h3>Lounge Entertainment</h3>
                            <p>Ruang tunggu VIP dengan sofa premium dan TV layar lebar</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="slider-controls">
                <button class="slider-btn" onclick="previousSlide()">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="slider-btn" onclick="nextSlide()">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            <div class="slider-indicators" id="sliderIndicators"></div>
        </div>
    </section>

    <section class="booking" id="booking">
        <div class="booking-container">
            <div class="booking-card">
                <h2 class="booking-title">Book Your Service</h2>
                <form id="bookingForm" onsubmit="return handleBooking(event)">
                    <div class="form-group">
                        <label class="form-label">Nama Lengkap</label>
                        <div style="position: relative;">
                            <i class="fas fa-user form-icon"></i>
                            <input type="text" class="form-input" id="name" placeholder="Masukkan nama lengkap" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">NO POLISI</label>
                        <div class="plat-nomor-container">
                            <input type="text" id="plat_kode" maxlength="1" placeholder="B" class="plat-input plat-part-a" oninput="handlePlatInput(this, 'letters')" required>
                            <span class="separator">-</span>
                            <input type="text" id="plat_angka" maxlength="4" placeholder="1234" class="plat-input plat-part-b" oninput="handlePlatInput(this, 'numbers')" required>
                            <span class="separator">-</span>
                            <input type="text" id="plat_huruf" maxlength="3" placeholder="ABC" class="plat-input plat-part-c" oninput="handlePlatInput(this, 'letters')" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Nomor Telepon</label>
                        <div style="position: relative;">
                            <i class="fas fa-phone form-icon"></i>
                            <input type="tel" class="form-input" id="phone" placeholder="08123456789" oninput="handlePhoneInput(this)" maxlength="15" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Type Mobil</label>
                        <div style="position: relative;">
                            <i class="fas fa-car form-icon"></i>
                            <input type="text" class="form-input" id="model" placeholder="Type Mobil" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Jenis Layanan</label>
                        <div class="custom-select-wrapper">
                            <i class="fas fa-cog form-icon"></i>
                            <div class="custom-select" id="serviceDropdown">
                                <div class="custom-select-trigger">Pilih jenis layanan</div>
                                <div class="custom-options">
                                    <div class="custom-optgroup">First Maintenance ICE</div>
                                    <div class="custom-option" data-value="first_maintenance_1000">First Maintenance (1.000 km/1 Bln)</div>
                                    <div class="custom-option" data-value="first_maintenance_5000">First Maintenance (5.000 km/3 Bln)</div>
                                    <div class="custom-optgroup">First Maintenance EV</div>
                                    <div class="custom-option" data-value="first_maintenance_ev_5000">First Maintenance EV (5.000 km/6 Bln)</div>
                                    <div class="custom-optgroup">Free Maintenance</div>
                                    <div class="custom-option" data-value="Tiggo_5X_Cross_Free">Tiggo 5X / Cross Series: Free Maintenance (5.000 km/6 Bln) - (10.000 km/12 Bln) - (20.000 km/24 Bln) - (30.000 km/36 Bln) - (40.000 km/48 Bln) - (60.000 km/72 Bln)</div>
                                    <div class="custom-option" data-value="Tiggo_8_Free">Tiggo 8 Series: Free Maintenance (15.000 km/12 Bln) - (30.000 km/36 Bln) - (45.000 km/48 Bln) - (60.000 km/72 Bln)</div>
                                    <div class="custom-option" data-value="EV_Free">EV Series: Free Maintenance (5.000 km/6 Bln) - (15.000 km/12 Bln) - (30.000 km/36 Bln) - (45.000 km/48 Bln) - (60.000 km/72 Bln)</div>
                                    <div class="custom-option" data-value="CSH_Free">CSH Series: Free Maintenance (1.000 km/1 Bln) - (15.000 km/12 Bln) - (30.000 km/36 Bln) - (45.000 km/48 Bln) - (60.000 km/72 Bln)</div>
                                    <div class="custom-optgroup">Lainnya</div>
                                    <div class="custom-option" data-value="Other">Other</div>
                                </div>
                            </div>
                            <input type="hidden" id="service" name="service" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Tanggal Booking</label>
                        <div style="position: relative;">
                            <i class="fas fa-calendar form-icon"></i>
                            <input type="date" class="form-input" id="date" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Waktu Booking</label>
                        <div style="position: relative;">
                            <i class="fas fa-clock form-icon"></i>
                            <select class="form-input" id="time" required>
                                <option value="">Pilih Waktu</option>
                                <option value="08:00">08:00</option>
                                <option value="08:30">08:30</option>
                                <option value="09:00">09:00</option>
                                <option value="09:30">09:30</option>
                                <option value="10:00">10:00</option>
                                <option value="10:30">10:30</option>
                                <option value="11:00">11:00</option>
                                <option value="11:30">11:30</option>
                                <option value="13:00">13:00</option>
                                <option value="13:30">13:30</option>
                                <option value="14:00">14:00</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Catatan Tambahan</label>
                        <div style="position: relative;">
                            <i class="fas fa-comment form-icon"></i>
                            <textarea class="form-input" id="Keluhan" placeholder="Keluhan atau kebutuhan khusus..." rows="3"></textarea>
                        </div>
                    </div>

                    <button type="submit" class="submit-btn">
                        <i class="fas fa-paper-plane"></i>
                        Submit Booking
                    </button>
                </form>
            </div>
        </div>
    </section>

    <section class="about" id="about">
        <div class="about-container">
            <div class="about-content">
                <h2>Mengapa Memilih Chery Arta?</h2>
                <p>Dengan pengalaman lebih dari 15 tahun di industri otomotif, Chery Arta telah menjadi pilihan utama untuk perawatan dan perbaikan kendaraan Anda.</p>
                <div class="about-features">
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-award"></i>
                        </div>
                        <span>Teknisi Bersertifikat</span>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-tools"></i>
                        </div>
                        <span>Peralatan Modern</span>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <span>Layanan Cepat</span>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <span>Garansi Kualitas</span>
                    </div>
                </div>
            </div>
            <div class="about-image">
                <svg viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#1e3a8a;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#dc2626;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <rect x="50" y="100" width="300" height="150" fill="url(#grad)" rx="10"/>
                    <rect x="80" y="150" width="80" height="100" fill="rgba(255,255,255,0.2)" rx="5"/>
                    <rect x="240" y="150" width="80" height="100" fill="rgba(255,255,255,0.2)" rx="5"/>
                    <rect x="120" y="120" width="30" height="20" fill="rgba(255,255,255,0.3)" rx="3"/>
                    <rect x="170" y="120" width="30" height="20" fill="rgba(255,255,255,0.3)" rx="3"/>
                    <rect x="220" y="120" width="30" height="20" fill="rgba(255,255,255,0.3)" rx="3"/>
                    <rect x="140" y="80" width="120" height="30" fill="#fbbf24" rx="5"/>
                    <text x="200" y="100" text-anchor="middle" fill="#1e293b" font-family="Arial" font-size="12" font-weight="bold">CHERY ARTA</text>
                </svg>
            </div>
        </div>
    </section>

    <section class="contact" id="contact">
        <div class="contact-container">
            <div class="contact-card">
                <div class="contact-icon">
                    <i class="fas fa-map-marker-alt"></i>
                </div>
                <h3>Alamat</h3>
                <p>Jl. Jend. Sudirman No.1, Kranji, Kec. Bekasi Bar.<br>Kota Bks, Jawa Barat</p>
            </div>

            <div class="contact-card">
                <div class="contact-icon">
                    <i class="fas fa-phone"></i>
                </div>
                <h3>Telepon</h3>
                <p>(021) 38317201<br>0895-4045-46904</p>
            </div>

            <div class="contact-card">
                <div class="contact-icon">
                    <i class="fas fa-envelope"></i>
                </div>
                <h3>Email</h3>
                <p>Cheryaftersales.10254719</p>
                    <p>@gmail.com</p>
            </div>

            <div class="contact-card">
                <div class="contact-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <h3>Jam Operasional</h3>
                <p>Senin - Jumat: 08:00 - 16:00<br>Sabtu: 08:00 - 14:00</p>
            </div>
        </div>
    </section>

    <section class="service-panel" id="cekService">
        <div class="service-container">
            <h2 class="section-title">Cek Status Service</h2>
            <div class="service-search">
                <input type="text" id="searchPlat" placeholder="Contoh: B-1234-CD" class="search-input">
                <button class="search-btn" onclick="searchBooking()">
                    <i class="fas fa-search"></i>
                    Cari
                </button>
            </div>
            
            <div class="service-actions">
                <button class="service-btn back-btn" onclick="hideServicePanel()">
                    <i class="fas fa-arrow-left"></i>
                    Kembali
                </button>
                <button class="service-btn" onclick="refreshCekService()" style="background: #3b82f6; color: white;">
                    <i class="fas fa-sync-alt"></i>
                    Refresh
                </button>
            </div>
            
            <!-- Desktop Table View -->
            <div class="table-wrapper">
                <table class="table" id="serviceTable" style="display: none;">
                    <thead>
                        <tr>
                            <th>Tanggal</th>
                            <th>Waktu</th>
                            <th>Nama</th>
                            <th>Plat Nomor</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="serviceTableBody"></tbody>
                </table>
            </div>

            <!-- Mobile Card View -->
            <div class="mobile-card-view" id="serviceCardView" style="display: none;">
            </div>

            <div id="noDataMessage" style="text-align: center; padding: 2rem; color: #666;">
                Masukkan nomor plat untuk melihat status service
            </div>
        </div>
    </section>

    <section class="admin-panel" id="adminPanel">
        <div class="admin-container">
            <div class="admin-header">
                <h2 class="admin-title">Admin Panel - Data Booking</h2>
                <div class="admin-actions">
                    <button class="admin-btn export-btn" onclick="exportToExcel()">
                        <i class="fas fa-download"></i>
                        Export Excel
                    </button>
                    <button class="admin-btn" onclick="exportToGoogleSheets()" style="background: #0f9d58; color: white;">
                        <i class="fab fa-google"></i>
                        Export Sheets
                    </button>
                    <button class="admin-btn" onclick="refreshBookings()" style="background: #3b82f6; color: white;">
                        <i class="fas fa-sync-alt"></i>
                        Refresh
                    </button>
                    <button class="admin-btn logout-btn" onclick="adminLogout()">
                        <i class="fas fa-sign-out-alt"></i>
                        Logout
                    </button>
                </div>
            </div>

            <div class="admin-filters" style="background: white; padding: 1.5rem; border-radius: 15px; margin-bottom: 2rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
                <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem; color: var(--chery-dark);">
                    <i class="fas fa-filter"></i> Filter Data
                </h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                    <div>
                        <label style="display: block; font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem; color: #64748b;">Cari Nama/Plat</label>
                        <input type="text" id="filterSearch" placeholder="Nama atau Plat Nomor" style="width: 100%; padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1rem;" oninput="applyFilters()">
                    </div>
                    <div>
                        <label style="display: block; font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem; color: #64748b;">Status</label>
                        <select id="filterStatus" style="width: 100%; padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1rem;" onchange="applyFilters()">
                            <option value="">Semua Status</option>
                            <option value="Successful">Successful</option>
                            <option value="Pending">Pending</option>
                            <option value="Cancelled">Cancelled</option>
                            <option value="In Progress">In Progress</option>
                            <option value="Completed">Completed</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem; color: #64748b;">Tanggal Dari</label>
                        <input type="date" id="filterDateFrom" style="width: 100%; padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1rem;" onchange="applyFilters()">
                    </div>
                    <div>
                        <label style="display: block; font-size: 0.875rem; font-weight: 500; margin-bottom: 0.5rem; color: #64748b;">Tanggal Sampai</label>
                        <input type="date" id="filterDateTo" style="width: 100%; padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1rem;" onchange="applyFilters()">
                    </div>
                </div>
                <div style="margin-top: 1rem; display: flex; gap: 0.75rem; flex-wrap: wrap;">
                    <button onclick="applyFilters()" style="padding: 0.75rem 1.5rem; background: var(--chery-blue); color: white; border: none; border-radius: 10px; font-weight: 600; cursor: pointer;">
                        <i class="fas fa-search"></i> Terapkan Filter
                    </button>
                    <button onclick="clearFilters()" style="padding: 0.75rem 1.5rem; background: #e2e8f0; color: var(--chery-dark); border: none; border-radius: 10px; font-weight: 600; cursor: pointer;">
                        <i class="fas fa-times"></i> Reset Filter
                    </button>
                </div>
            </div>

            <!-- Desktop Table View -->
            <div class="table-wrapper">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Time</th>
                            <th>Name</th>
                            <th>Model</th>
                            <th>Plat Nomor</th>
                            <th>Service</th>
                            <th>Keluhan</th>
                            <th>Phone</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="bookingListBody"></tbody>
                </table>
            </div>

            <!-- Mobile Card View -->
            <div class="mobile-card-view" id="bookingCardView">
            </div>
        </div>
    </section>

    <div class="modal" id="loginModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeLoginModal()">&times;</button>
            <h3 class="modal-title">Admin Login</h3>
            <form id="loginForm">
                <input type="email" class="modal-input" id="adminEmail" placeholder="Email" required>
                <input type="password" class="modal-input" id="adminPassword" placeholder="Password" required>
                <button type="submit" class="modal-btn">Login</button>
            </form>
        </div>
    </div>

    <div class="modal" id="editModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeEditModal()">&times;</button>
            <h3 class="modal-title">Edit Booking</h3>
            <form id="editForm">
                <div>
                    <label class="modal-label">Nama</label>
                    <input type="text" class="modal-input" id="editName" required>
                </div>
                <div>
                    <label class="modal-label">Plat Nomor</label>
                    <input type="text" class="modal-input" id="editPlat" placeholder="B-1426-AZT" required>
                </div>
                <div>
                    <label class="modal-label">Telepon</label>
                    <input type="tel" class="modal-input" id="editPhone" oninput="handlePhoneInput(this)" maxlength="15" required>
                </div>
                <div>
                    <label class="modal-label">Model</label>
                    <input type="text" class="modal-input" id="editModel" required>
                </div>
                <div>
                    <label class="modal-label">Service</label>
                    <div class="custom-select-wrapper" style="position: relative;">
                        <div class="custom-select" id="editServiceDropdown" style="margin-bottom: 1rem;">
                            <div class="custom-select-trigger" style="padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 10px; background: white; color: #1e293b; cursor: pointer;">Pilih jenis layanan</div>
                            <div class="custom-options" style="background: #1e3a8a; border-radius: 10px; max-height: 300px;">
                                <div class="custom-optgroup">First Maintenance ICE</div>
                                <div class="custom-option" data-value="first_maintenance_1000">First Maintenance (1.000 km/1 Bln)</div>
                                <div class="custom-option" data-value="first_maintenance_5000">First Maintenance (5.000 km/3 Bln)</div>
                                <div class="custom-optgroup">First Maintenance EV</div>
                                <div class="custom-option" data-value="first_maintenance_ev_5000">First Maintenance EV (5.000 km/6 Bln)</div>
                                <div class="custom-optgroup">Free Maintenance</div>
                                <div class="custom-option" data-value="Tiggo_5X_Cross_Free">Tiggo 5X / Cross Series: Free Maintenance (5.000 km/6 Bln) - (10.000 km/12 Bln) - (20.000 km/24 Bln) - (30.000 km/36 Bln) - (40.000 km/48 Bln) - (60.000 km/72 Bln)</div>
                                <div class="custom-option" data-value="Tiggo_8_Free">Tiggo 8 Series: Free Maintenance (15.000 km/12 Bln) - (30.000 km/36 Bln) - (45.000 km/48 Bln) - (60.000 km/72 Bln)</div>
                                <div class="custom-option" data-value="EV_Free">EV Series: Free Maintenance (5.000 km/6 Bln) - (15.000 km/12 Bln) - (30.000 km/36 Bln) - (45.000 km/48 Bln) - (60.000 km/72 Bln)</div>
                                <div class="custom-option" data-value="CSH_Free">CSH Series: Free Maintenance (1.000 km/1 Bln) - (15.000 km/12 Bln) - (30.000 km/36 Bln) - (45.000 km/48 Bln) - (60.000 km/72 Bln)</div>
                                <div class="custom-optgroup">Lainnya</div>
                                <div class="custom-option" data-value="Other">Other</div>
                            </div>
                        </div>
                        <input type="hidden" id="editService" name="editService" required>
                    </div>
                </div>
                <div>
                    <label class="modal-label">Tanggal</label>
                    <input type="date" class="modal-input" id="editDate" required>
                </div>
                <div>
                    <label class="modal-label">Waktu</label>
                    <input type="time" class="modal-input" id="editTime" required>
                </div>
                <div>
                    <label class="modal-label">Keluhan</label>
                    <textarea class="modal-input" id="editKeluhan" rows="2" style="resize: vertical;"></textarea>
                </div>
                <div>
                    <label class="modal-label">Status</label>
                    <select class="modal-input" id="editStatus" required style="padding: 0.75rem;">
                        <option value="Successful">Successful</option>
                        <option value="Pending">Pending</option>
                        <option value="Cancelled">Cancelled</option>
                        <option value="In Progress">In Progress</option>
                        <option value="Completed">Completed</option>
                    </select>
                </div>
                <button type="submit" class="modal-btn">Simpan Perubahan</button>
            </form>
        </div>
    </div>

    <div class="image-preview-modal" id="imagePreviewModal">
        <div class="image-preview-content">
            <button class="image-preview-close" onclick="closeImagePreview()">&times;</button>
            <button class="image-preview-nav image-preview-prev" onclick="prevImage()">
                <i class="fas fa-chevron-left"></i>
            </button>
            <img src="" alt="Preview" class="image-preview-img" id="previewImage">
            <button class="image-preview-nav image-preview-next" onclick="nextImage()">
                <i class="fas fa-chevron-right"></i>
            </button>
            <div class="image-preview-caption" id="previewCaption">
                <h3></h3>
                <p></p>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">Chery Arta</div>
            <p>&copy; 2024 Chery Arta. All rights reserved.</p>
        </div>
    </footer>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js';
        import { getDatabase, ref, onValue, get, child, remove, set } from 'https://www.gstatic.com/firebasejs/10.13.1/firebase-database.js';

        const firebaseConfig = {
            apiKey: "AIzaSyCpmHGOa04IXtzTSBs4k9r6hGl1skBAHUk",
            authDomain: "chery-arta-booking-service.firebaseapp.com",
            databaseURL: "https://chery-arta-booking-service-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "chery-arta-booking-service",
            storageBucket: "chery-arta-booking-service.firebasestorage.app",
            messagingSenderId: "808532000775",
            appId: "1:808532000775:web:048e11e538b6196e03aaa2",
            measurementId: "G-WJ2XFET4PJ"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        let allBookings = [];
        let filteredBookings = [];
        let currentSlide = 0;
        let isAdminLoggedIn = false;
        let editingBookingId = null;
        let currentPreviewIndex = 0;

        const facilityData = [
            {
                img: "https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/frontside.webp",
                title: "Customer Service Center",
                desc: "Meja pelayanan customer service yang profesional"
            },
            {
                img: "https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/IMG-20250919-WA0014.jpg",
                title: "Showroom Chery",
                desc: "Showroom eksklusif menampilkan koleksi lengkap kendaraan Chery"
            },
            {
                img: "https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/IMG-20250919-WA0015.jpg",
                title: "Ruang Tunggu Premium",
                desc: "Ruang tunggu eksklusif dengan sofa nyaman dan mural pemandangan pegunungan"
            },
            {
                img: "https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/IMG-20250919-WA0019.jpg",
                title: "Kids Play Area",
                desc: "Area bermain anak yang aman dan menyenangkan"
            },
            {
                img: "https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/IMG-20250919-WA0018.jpg",
                title: "Workshop Modern",
                desc: "Bengkel dengan teknologi terdepan dan peralatan canggih"
            },
            {
                img: "https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/fasilitas2.webp",
                title: "Area Diskusi Santai",
                desc: "Area santai dengan meja bulat yang nyaman untuk berdiskusi dengan keluarga"
            },
            {
                img: "https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/fasilitas3.webp",
                title: "Ruang Konsultasi",
                desc: "Ruang meeting modern untuk diskusi dan konsultasi mengenai perawatan kendaraan"
            },
            {
                img: "https://raw.githubusercontent.com/AdminCheryarta01/chery-booking-service/refs/heads/main/img/fasilitas4.webp",
                title: "Lounge Entertainment",
                desc: "Ruang tunggu VIP dengan sofa premium dan TV layar lebar"
            }
        ];

        function updateSlider() {
            const track = document.getElementById('sliderTrack');
            const indicators = document.querySelectorAll('.indicator');
            
            track.style.transform = `translateX(-${currentSlide * 100}%)`;
            
            indicators.forEach((indicator, index) => {
                indicator.classList.toggle('active', index === currentSlide);
            });
        }

        window.nextSlide = function() {
            currentSlide = (currentSlide + 1) % 8;
            updateSlider();
        };

        window.previousSlide = function() {
            currentSlide = (currentSlide - 1 + 8) % 8;
            updateSlider();
        };

        function initSliderIndicators() {
            const container = document.getElementById('sliderIndicators');
            for (let i = 0; i < 8; i++) {
                const indicator = document.createElement('div');
                indicator.className = 'indicator';
                if (i === 0) indicator.classList.add('active');
                indicator.onclick = () => {
                    currentSlide = i;
                    updateSlider();
                };
                container.appendChild(indicator);
            }
        }

        let touchStartX = 0;
        let touchEndX = 0;
        let touchStartY = 0;
        let touchEndY = 0;

        function initTouchSupport() {
            const sliderContainer = document.querySelector('.slider-container');
            
            sliderContainer.addEventListener('touchstart', (e) => {
                touchStartX = e.changedTouches[0].screenX;
                touchStartY = e.changedTouches[0].screenY;
            }, { passive: true });

            sliderContainer.addEventListener('touchend', (e) => {
                touchEndX = e.changedTouches[0].screenX;
                touchEndY = e.changedTouches[0].screenY;
                handleSwipe();
            }, { passive: true });

            let isDragging = false;
            let startX = 0;

            sliderContainer.addEventListener('mousedown', (e) => {
                isDragging = true;
                startX = e.pageX;
                sliderContainer.style.cursor = 'grabbing';
            });

            sliderContainer.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                e.preventDefault();
            });

            sliderContainer.addEventListener('mouseup', (e) => {
                if (!isDragging) return;
                isDragging = false;
                sliderContainer.style.cursor = 'grab';
                
                const endX = e.pageX;
                const diff = startX - endX;

                if (Math.abs(diff) > 50) {
                    if (diff > 0) {
                        window.nextSlide();
                    } else {
                        window.previousSlide();
                    }
                }
            });

            sliderContainer.addEventListener('mouseleave', () => {
                if (isDragging) {
                    isDragging = false;
                    sliderContainer.style.cursor = 'grab';
                }
            });
        }

        function handleSwipe() {
            const diffX = touchStartX - touchEndX;
            const diffY = touchStartY - touchEndY;

            if (Math.abs(diffX) > Math.abs(diffY)) {
                if (Math.abs(diffX) > 50) {
                    if (diffX > 0) {
                        window.nextSlide();
                    } else {
                        window.previousSlide();
                    }
                }
            }
        }

        let previewTouchStartX = 0;
        let previewTouchEndX = 0;
        let previewTouchStartY = 0;
        let previewTouchEndY = 0;

        function initImagePreviewSwipe() {
            const previewModal = document.getElementById('imagePreviewModal');
            const previewImg = document.getElementById('previewImage');
            
            previewImg.addEventListener('touchstart', (e) => {
                previewTouchStartX = e.changedTouches[0].screenX;
                previewTouchStartY = e.changedTouches[0].screenY;
            }, { passive: true });

            previewImg.addEventListener('touchend', (e) => {
                previewTouchEndX = e.changedTouches[0].screenX;
                previewTouchEndY = e.changedTouches[0].screenY;
                handlePreviewSwipe();
            }, { passive: true });

            let isDragging = false;
            let startX = 0;

            previewImg.addEventListener('mousedown', (e) => {
                isDragging = true;
                startX = e.pageX;
                previewImg.style.cursor = 'grabbing';
            });

            previewImg.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                e.preventDefault();
            });

            previewImg.addEventListener('mouseup', (e) => {
                if (!isDragging) return;
                isDragging = false;
                previewImg.style.cursor = 'grab';
                
                const endX = e.pageX;
                const diff = startX - endX;

                if (Math.abs(diff) > 50) {
                    if (diff > 0) {
                        window.nextImage();
                    } else {
                        window.prevImage();
                    }
                }
            });

            previewImg.addEventListener('mouseleave', () => {
                if (isDragging) {
                    isDragging = false;
                    previewImg.style.cursor = 'grab';
                }
            });
        }

        function handlePreviewSwipe() {
            const diffX = previewTouchStartX - previewTouchEndX;
            const diffY = previewTouchStartY - previewTouchEndY;

            if (Math.abs(diffX) > Math.abs(diffY)) {
                if (Math.abs(diffX) > 50) {
                    if (diffX > 0) {
                        window.nextImage();
                    } else {
                        window.prevImage();
                    }
                }
            }
        }

        setInterval(window.nextSlide, 5000);

        window.handleBooking = async function(event) {
            event.preventDefault();

            const name = document.getElementById('name').value.trim();
            const plat_kode = document.getElementById('plat_kode').value.trim().toUpperCase();
            const plat_angka = document.getElementById('plat_angka').value.trim();
            const plat_huruf = document.getElementById('plat_huruf').value.trim().toUpperCase();
            const Plat_Nomor = `${plat_kode}-${plat_angka}-${plat_huruf}`;
            const phone = document.getElementById('phone').value.trim();
            const model = document.getElementById('model').value.trim();
            const service = document.getElementById('service').value;
            const date = document.getElementById('date').value;
            const time = document.getElementById('time').value;
            const Keluhan = document.getElementById('Keluhan').value.trim();

            if (!name || !plat_kode || !plat_angka || !plat_huruf || !phone || !model || !service || !date || !time) {
                alert('Please fill in all required fields.');
                return false;
            }

            const selectedDate = new Date(date);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            selectedDate.setHours(0, 0, 0, 0);

            const daysDifference = Math.floor((selectedDate - today) / (1000 * 60 * 60 * 24));

            if (daysDifference < 1) {
                alert(' Booking Tidak Diizinkan!\n\nBooking wajib dilakukan minimal H-1 (satu hari sebelum hari pelaksanaan).\n\nContoh:\n- Hari ini: ' + today.toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }) + '\n- Booking paling cepat untuk: ' + new Date(today.getTime() + 24*60*60*1000).toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }) + '\n\nSilakan pilih tanggal yang lebih jauh.');
                return false;}

            if (!/^[A-Z]{1,2}$/.test(plat_kode)) {
                alert('Kode wilayah harus berupa 1-2 huruf (contoh: B atau AB)');
                return false;
            }

            if (!/^[0-9]{1,4}$/.test(plat_angka)) {
                alert('Nomor registrasi harus berupa 1-4 angka (contoh: 1234)');
                return false;
            }

            if (!/^[A-Z]{1,3}$/.test(plat_huruf)) {
                alert('Kode belakang harus berupa 1-3 huruf (contoh: CD)');
                return false;
            }

            const cleanPhone = phone.replace(/[-\s]/g, '');
            if (!/^(\+62|62|0)[0-9]{9,13}$/.test(cleanPhone)) {
                alert('Nomor telepon tidak valid. Format: 08123456789 atau +628123456789');
                return false;
            }

            try {
                const snapshot = await get(child(ref(db), "bookings"));
                let bookingCount = 0;
                
                if (snapshot.exists()) {
                    snapshot.forEach((childSnap) => {
                        const booking = childSnap.val();
                        if (booking.date === date && booking.time === time) {
                            bookingCount++;
                        }
                    });
                }

                if (bookingCount >= 2) {
                    alert(`Maaf, waktu ${time} pada tanggal ${date} sudah penuh!\n\nMaksimal 2 booking per jam.\nSilakan pilih waktu lain.`);
                    return false;
                }

                const bookingData = { name, Plat_Nomor, phone, model, service, date, time, Keluhan, status: 'Successful' };

                const newBookingRef = ref(db, `bookings/${Date.now()}`);
                await set(newBookingRef, bookingData);
                alert(`Booking berhasil!\n\nWaktu: ${time}\nTanggal: ${date}\n\nSlot tersisa: ${1 - bookingCount} booking lagi untuk jam ini.`);
                event.target.reset();
                
            } catch (error) {
                console.error("Error submitting booking:", error);
                alert("Failed to submit booking. Please try again.");
            }
            return false;
        };

        window.handlePlatInput = function(input, type) {
            if (type === 'letters') {
                input.value = input.value.replace(/[^A-Za-z]/g, '').toUpperCase();
            } else if (type === 'numbers') {
                input.value = input.value.replace(/[^0-9]/g, '');
            }

            if (input.value.length >= input.maxLength) {
                const inputs = ['plat_kode', 'plat_angka', 'plat_huruf'];
                const currentIndex = inputs.indexOf(input.id);
                if (currentIndex < inputs.length - 1) {
                    const nextInput = document.getElementById(inputs[currentIndex + 1]);
                    if (nextInput) nextInput.focus();
                }
            }
        };

        window.handlePhoneInput = function(input) {
            let value = input.value.replace(/[^\d+]/g, '');
            
            if (value.includes('+')) {
                const parts = value.split('+');
                value = '+' + parts.join('').replace(/\+/g, '');
            }
            
            if (value.startsWith('0')) {
                if (value.length > 4) {
                    value = value.slice(0, 4) + '-' + value.slice(4);
                }
                if (value.length > 9) {
                    value = value.slice(0, 9) + '-' + value.slice(9);
                }
            } else if (value.startsWith('+62')) {
                if (value.length > 3) {
                    value = value.slice(0, 3) + '-' + value.slice(3);
                }
                if (value.length > 7) {
                    value = value.slice(0, 7) + '-' + value.slice(7);
                }
                if (value.length > 12) {
                    value = value.slice(0, 12) + '-' + value.slice(12);
                }
            } else if (value.startsWith('62')) {
                if (value.length > 2) {
                    value = value.slice(0, 2) + '-' + value.slice(2);
                }
                if (value.length > 6) {
                    value = value.slice(0, 6) + '-' + value.slice(6);
                }
                if (value.length > 11) {
                    value = value.slice(0, 11) + '-' + value.slice(11);
                }
            }
            
            input.value = value;
        };

        window.showAdminLogin = function() {
            document.getElementById('loginModal').classList.add('show');
        };

        window.closeLoginModal = function() {
            document.getElementById('loginModal').classList.remove('show');
        };

        window.closeEditModal = function() {
            document.getElementById('editModal').classList.remove('show');
            editingBookingId = null;
        };

        window.openImagePreview = function(index) {
            currentPreviewIndex = index;
            const modal = document.getElementById('imagePreviewModal');
            const img = document.getElementById('previewImage');
            const caption = document.getElementById('previewCaption');
            
            img.src = facilityData[currentPreviewIndex].img;
            caption.querySelector('h3').textContent = facilityData[currentPreviewIndex].title;
            caption.querySelector('p').textContent = facilityData[currentPreviewIndex].desc;
            
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
        };

        window.closeImagePreview = function() {
            document.getElementById('imagePreviewModal').classList.remove('show');
            document.body.style.overflow = 'auto';
        };

        window.prevImage = function() {
            currentPreviewIndex = (currentPreviewIndex - 1 + facilityData.length) % facilityData.length;
            const img = document.getElementById('previewImage');
            const caption = document.getElementById('previewCaption');
            
            img.src = facilityData[currentPreviewIndex].img;
            caption.querySelector('h3').textContent = facilityData[currentPreviewIndex].title;
            caption.querySelector('p').textContent = facilityData[currentPreviewIndex].desc;
        };

        window.nextImage = function() {
            currentPreviewIndex = (currentPreviewIndex + 1) % facilityData.length;
            const img = document.getElementById('previewImage');
            const caption = document.getElementById('previewCaption');
            
            img.src = facilityData[currentPreviewIndex].img;
            caption.querySelector('h3').textContent = facilityData[currentPreviewIndex].title;
            caption.querySelector('p').textContent = facilityData[currentPreviewIndex].desc;
        };

        window.editBooking = function(id, booking) {
            editingBookingId = id;
            document.getElementById('editName').value = booking.name || '';
            document.getElementById('editPlat').value = booking.Plat_Nomor || '';
            document.getElementById('editPhone').value = booking.phone || '';
            document.getElementById('editModel').value = booking.model || '';
            
            const editServiceDropdown = document.getElementById('editServiceDropdown');
            const editServiceTrigger = editServiceDropdown.querySelector('.custom-select-trigger');
            const editServiceHidden = document.getElementById('editService');
            const editOptions = editServiceDropdown.querySelectorAll('.custom-option');
            
            editOptions.forEach(option => {
                option.classList.remove('selected');
                if (option.getAttribute('data-value') === booking.service) {
                    option.classList.add('selected');
                    editServiceTrigger.textContent = option.textContent;
                    editServiceHidden.value = booking.service;
                }
            });
            
            document.getElementById('editDate').value = booking.date || '';
            document.getElementById('editTime').value = booking.time || '';
            document.getElementById('editKeluhan').value = booking.Keluhan || '';
            document.getElementById('editStatus').value = booking.status || 'Successful';
            
            document.getElementById('editModal').classList.add('show');
        };

        window.showCekService = function() {
            document.querySelectorAll('.hero, .facilities, .booking, .about, .contact').forEach(el => el.style.display = 'none');
            document.getElementById('adminPanel').classList.remove('show');
            document.getElementById('cekService').classList.add('show');
            sessionStorage.setItem('currentPage', 'cekService');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        };

        window.hideServicePanel = function() {
            document.getElementById('cekService').classList.remove('show');
            document.querySelectorAll('.hero, .facilities, .booking, .about, .contact').forEach(el => el.style.display = 'block');
            sessionStorage.removeItem('currentPage');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        };

        window.goToHome = function() {
            document.getElementById('cekService').classList.remove('show');
            document.getElementById('adminPanel').classList.remove('show');
            document.querySelectorAll('.hero, .facilities, .booking, .about, .contact').forEach(el => el.style.display = 'block');
            sessionStorage.removeItem('currentPage');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        };

        window.toggleMobileMenu = function() {
            const mobileMenu = document.getElementById('mobileMenu');
            const menuBtn = document.querySelector('.mobile-menu-btn i');
            
            if (mobileMenu.classList.contains('show')) {
                mobileMenu.classList.remove('show');
                menuBtn.classList.remove('fa-times');
                menuBtn.classList.add('fa-bars');
            } else {
                mobileMenu.classList.add('show');
                menuBtn.classList.remove('fa-bars');
                menuBtn.classList.add('fa-times');
            }
        };

        window.closeMobileMenu = function() {
            const mobileMenu = document.getElementById('mobileMenu');
            const menuBtn = document.querySelector('.mobile-menu-btn i');
            mobileMenu.classList.remove('show');
            menuBtn.classList.remove('fa-times');
            menuBtn.classList.add('fa-bars');
        };

        document.addEventListener('click', function(event) {
            const mobileMenu = document.getElementById('mobileMenu');
            const menuBtn = document.querySelector('.mobile-menu-btn');
            
            if (mobileMenu && menuBtn && 
                !mobileMenu.contains(event.target) && 
                !menuBtn.contains(event.target) &&
                mobileMenu.classList.contains('show')) {
                closeMobileMenu();
            }
        });

        window.searchBooking = async function() {
            const searchPlat = document.getElementById('searchPlat').value.trim().toUpperCase();
            const serviceTableBody = document.getElementById('serviceTableBody');
            const serviceTable = document.getElementById('serviceTable');
            const serviceCardView = document.getElementById('serviceCardView');
            const noDataMessage = document.getElementById('noDataMessage');
            
            if (!searchPlat) {
                alert('Mohon masukkan nomor plat kendaraan');
                return;
            }
            
            try {
                const snapshot = await get(child(ref(db), "bookings"));
                const bookings = [];
                
                if (snapshot.exists()) {
                    snapshot.forEach((childSnap) => {
                        const b = childSnap.val();
                        if (b.Plat_Nomor && b.Plat_Nomor.toUpperCase().includes(searchPlat)) {
                            bookings.push(b);
                        }
                    });
                }
                
                displaySearchResults(bookings, serviceTableBody, serviceTable, serviceCardView, noDataMessage);
            } catch (error) {
                console.error("Error searching bookings:", error);
                alert("Terjadi kesalahan saat mencari data booking");
            }
        };

        window.refreshCekService = async function() {
            const refreshBtn = event.target.closest('button');
            const icon = refreshBtn.querySelector('i');
            const searchPlat = document.getElementById('searchPlat').value.trim().toUpperCase();
            
            if (!searchPlat) {
                alert('Mohon masukkan nomor plat terlebih dahulu');
                return;
            }
            
            icon.style.animation = 'spin 1s linear infinite';
            refreshBtn.disabled = true;
            
            try {
                const snapshot = await get(child(ref(db), "bookings"));
                const bookings = [];
                
                if (snapshot.exists()) {
                    snapshot.forEach((childSnap) => {
                        const b = childSnap.val();
                        if (b.Plat_Nomor && b.Plat_Nomor.toUpperCase().includes(searchPlat)) {
                            bookings.push(b);
                        }
                    });
                }
                
                const serviceTableBody = document.getElementById('serviceTableBody');
                const serviceTable = document.getElementById('serviceTable');
                const serviceCardView = document.getElementById('serviceCardView');
                const noDataMessage = document.getElementById('noDataMessage');
                
                displaySearchResults(bookings, serviceTableBody, serviceTable, serviceCardView, noDataMessage);
                
                setTimeout(() => {
                    icon.style.animation = '';
                    refreshBtn.disabled = false;
                    alert('Data berhasil direfresh!');
                }, 1000);
            } catch (error) {
                console.error("Error refreshing:", error);
                icon.style.animation = '';
                refreshBtn.disabled = false;
                alert("Gagal memuat ulang data");
            }
        };

        function displaySearchResults(bookings, serviceTableBody, serviceTable, serviceCardView, noDataMessage) {
            serviceTableBody.innerHTML = '';
            serviceCardView.innerHTML = '';
            
            if (bookings.length === 0) {
                serviceTable.style.display = 'none';
                serviceCardView.style.display = 'none';
                noDataMessage.textContent = 'Tidak ada data booking dengan nomor plat tersebut';
                noDataMessage.style.display = 'block';
                return;
            }
            
            serviceTable.style.display = 'table';
            serviceCardView.style.display = 'block';
            noDataMessage.style.display = 'none';
            
            bookings.forEach(booking => {
                let statusClass = 'status-successful';
                const status = booking.status || 'Successful';
                
                if (status === 'Pending') statusClass = 'status-pending';
                else if (status === 'Cancelled') statusClass = 'status-cancelled';
                else if (status === 'In Progress') statusClass = 'status-in-progress';
                else if (status === 'Completed') statusClass = 'status-completed';
                
                // Desktop Table Row
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${booking.date || ''}</td>
                    <td>${booking.time || ''}</td>
                    <td>${booking.name || ''}</td>
                    <td>${booking.Plat_Nomor || ''}</td>
                    <td><span class="status-badge ${statusClass}">${status}</span></td>
                `;
                serviceTableBody.appendChild(row);

                // Mobile Card View
                const card = document.createElement('div');
                card.className = 'booking-card-mobile';
                card.innerHTML = `
                    <div class="card-header-mobile">
                        <div>
                            <div class="card-name-mobile">${booking.name || ''}</div>
                            <div class="card-date-mobile">${booking.date || ''}  ${booking.time || ''}</div>
                        </div>
                        <span class="status-badge ${statusClass}">${status}</span>
                    </div>
                    <div class="card-body-mobile">
                        <div class="card-row-mobile">
                            <span class="card-label-mobile">Plat Nomor</span>
                            <span class="card-value-mobile">${booking.Plat_Nomor || ''}</span>
                        </div>
                    </div>
                `;
                serviceCardView.appendChild(card);
            });
        }

        window.displayBookings = function() {
            onValue(ref(db, "bookings"), (snapshot) => {
                allBookings = [];
                
                if (snapshot.exists()) {
                    snapshot.forEach((childSnap) => {
                        allBookings.push({
                            id: childSnap.key,
                            ...childSnap.val()
                        });
                    });
                }
                
                applyFilters();
            });
        };

        window.applyFilters = function() {
            const searchText = document.getElementById('filterSearch')?.value.toLowerCase() || '';
            const statusFilter = document.getElementById('filterStatus')?.value || '';
            const dateFrom = document.getElementById('filterDateFrom')?.value || '';
            const dateTo = document.getElementById('filterDateTo')?.value || '';
            
            filteredBookings = allBookings.filter(booking => {
                const matchSearch = !searchText || 
                    (booking.name && booking.name.toLowerCase().includes(searchText)) ||
                    (booking.Plat_Nomor && booking.Plat_Nomor.toLowerCase().includes(searchText));
                
                const matchStatus = !statusFilter || 
                    (booking.status || 'Successful') === statusFilter;
                
                const bookingDate = booking.date || '';
                const matchDateFrom = !dateFrom || bookingDate >= dateFrom;
                const matchDateTo = !dateTo || bookingDate <= dateTo;
                
                return matchSearch && matchStatus && matchDateFrom && matchDateTo;
            });
            
            renderBookingsTable();
        };

        window.clearFilters = function() {
            document.getElementById('filterSearch').value = '';
            document.getElementById('filterStatus').value = '';
            document.getElementById('filterDateFrom').value = '';
            document.getElementById('filterDateTo').value = '';
            
            filteredBookings = [...allBookings];
            renderBookingsTable();
        };

        function renderBookingsTable() {
            const tbody = document.getElementById('bookingListBody');
            const cardView = document.getElementById('bookingCardView');
            tbody.innerHTML = "";
            cardView.innerHTML = "";
            
            const bookingsToDisplay = filteredBookings.length > 0 || 
                document.getElementById('filterSearch')?.value || 
                document.getElementById('filterStatus')?.value ||
                document.getElementById('filterDateFrom')?.value ||
                document.getElementById('filterDateTo')?.value
                ? filteredBookings 
                : allBookings;

                // Sort bookings by ID (timestamp) in descending order - newest first
            const sortedBookings = [...bookingsToDisplay].sort((a, b) => {
                const idA = parseInt(a.id) || 0;
                const idB = parseInt(b.id) || 0;
                return idB - idA; // Descending order
            });
            
            if (sortedBookings.length === 0) {
                tbody.innerHTML = '<tr><td colspan="10" style="text-align: center; padding: 2rem;">Tidak ada data booking yang sesuai filter.</td></tr>';
                cardView.innerHTML = '<div style="text-align: center; padding: 2rem; color: #666;">Tidak ada data booking yang sesuai filter.</div>';
                return;
            }

            sortedBookings.forEach((booking) => {
                let statusClass = 'status-successful';
                const status = booking.status || 'Successful';
                
                if (status === 'Pending') statusClass = 'status-pending';
                else if (status === 'Cancelled') statusClass = 'status-cancelled';
                else if (status === 'In Progress') statusClass = 'status-in-progress';
                else if (status === 'Completed') statusClass = 'status-completed';
                
                // Desktop Table Row
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${booking.date || ''}</td>
                    <td>${booking.time || ''}</td>
                    <td>${booking.name || ''}</td>
                    <td>${booking.model || ''}</td>
                    <td>${booking.Plat_Nomor || ''}</td>
                    <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${booking.service || ''}</td>
                    <td>${booking.Keluhan || "None"}</td>
                    <td>${booking.phone || ''}</td>
                    <td><span class="status-badge ${statusClass}">${status}</span></td>
                    <td style="white-space: nowrap;">
                        <button onclick='editBooking("${booking.id}", ${JSON.stringify(booking).replace(/'/g, "&apos;")})' class="action-btn edit-btn">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button onclick="deleteBooking('${booking.id}')" class="action-btn delete-btn">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </td>
                `;
                tbody.appendChild(row);

                // Mobile Card View
                const card = document.createElement('div');
                card.className = 'booking-card-mobile';
                card.innerHTML = `
                    <div class="card-header-mobile">
                        <div>
                            <div class="card-name-mobile">${booking.name || ''}</div>
                            <div class="card-date-mobile">${booking.date || ''}  ${booking.time || ''}</div>
                        </div>
                        <span class="status-badge ${statusClass}">${status}</span>
                    </div>
                    <div class="card-body-mobile">
                        <div class="card-row-mobile">
                            <span class="card-label-mobile">Model</span>
                            <span class="card-value-mobile">${booking.model || ''}</span>
                        </div>
                        <div class="card-row-mobile">
                            <span class="card-label-mobile">Plat Nomor</span>
                            <span class="card-value-mobile">${booking.Plat_Nomor || ''}</span>
                        </div>
                        <div class="card-row-mobile">
                            <span class="card-label-mobile">Service</span>
                            <span class="card-value-mobile" style="font-size: 0.8rem; max-width: 60%; text-align: right;">${booking.service || ''}</span>
                        </div>
                        <div class="card-row-mobile">
                            <span class="card-label-mobile">Phone</span>
                            <span class="card-value-mobile">${booking.phone || ''}</span>
                        </div>
                        ${booking.Keluhan ? `
                        <div class="card-row-mobile" style="flex-direction: column; align-items: flex-start;">
                            <span class="card-label-mobile">Keluhan</span>
                            <span class="card-value-mobile" style="text-align: left; font-weight: 400; margin-top: 0.25rem;">${booking.Keluhan}</span>
                        </div>
                        ` : ''}
                    </div>
                    <div class="card-actions-mobile">
                        <button onclick='editBooking("${booking.id}", ${JSON.stringify(booking).replace(/'/g, "&apos;")})' class="action-btn edit-btn" style="flex: 1;">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button onclick="deleteBooking('${booking.id}')" class="action-btn delete-btn" style="flex: 1;">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                `;
                cardView.appendChild(card);
            });
        }

        window.refreshBookings = function() {
            const refreshBtn = event.target.closest('button');
            const icon = refreshBtn.querySelector('i');
            
            icon.style.animation = 'spin 1s linear infinite';
            refreshBtn.disabled = true;
            
            window.displayBookings();
            
            setTimeout(() => {
                icon.style.animation = '';
                refreshBtn.disabled = false;
                alert('Data berhasil direfresh!');
            }, 1000);
        };

        window.deleteBooking = async function(id) {
            if (!confirm("Are you sure you want to delete this booking?")) return;
            try {
                await remove(ref(db, "bookings/" + id));
                alert("Booking deleted successfully!");
            } catch (error) {
                console.error("Error deleting booking:", error);
                alert("Failed to delete booking.");
            }
        };

        window.exportToExcel = async function() {
            try {
                const snapshot = await get(child(ref(db), "bookings"));
                if (!snapshot.exists()) {
                    alert("No bookings to export.");
                    return;
                }
                
                const bookingsToExport = filteredBookings.length > 0 || 
                    document.getElementById('filterSearch')?.value || 
                    document.getElementById('filterStatus')?.value ||
                    document.getElementById('filterDateFrom')?.value ||
                    document.getElementById('filterDateTo')?.value
                    ? filteredBookings 
                    : allBookings;
                
                if (bookingsToExport.length === 0) {
                    alert("Tidak ada data untuk diekspor.");
                    return;
                }
                
                const exportData = bookingsToExport.map(booking => ({
                    'Name': booking.name || '',
                    'Plat Nomor': booking.Plat_Nomor || '',
                    'Phone': booking.phone || '',
                    'Model': booking.model || '',
                    'Service': booking.service || '',
                    'Date': booking.date || '',
                    'Time': booking.time || '',
                    'Keluhan': booking.Keluhan || '',
                    'Status': booking.status || 'Successful'
                }));
                
                const ws = XLSX.utils.json_to_sheet(exportData);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "Bookings");
                XLSX.writeFile(wb, "bookings.xlsx");
                
                alert("Data berhasil diekspor ke Excel!");
            } catch (error) {
                console.error("Export error:", error);
                alert("Failed to export bookings.");
            }
        };

        window.exportToGoogleSheets = async function() {
            try {
                let bookingsToExport = [];
                
                const hasActiveFilter = 
                    document.getElementById('filterSearch')?.value || 
                    document.getElementById('filterStatus')?.value ||
                    document.getElementById('filterDateFrom')?.value ||
                    document.getElementById('filterDateTo')?.value;
                
                if (hasActiveFilter && filteredBookings.length >= 0) {
                    bookingsToExport = filteredBookings;
                } else {
                    bookingsToExport = allBookings;
                }
                
                if (bookingsToExport.length === 0) {
                    alert("Tidak ada data untuk diekspor.\n\nPastikan ada data yang sesuai dengan filter Anda.");
                    return;
                }
                
                const headers = ['Date', 'Time', 'Name', 'Model', 'Plat Nomor', 'Service', 'Keluhan', 'Phone'];
                const rows = [headers];
                
                bookingsToExport.forEach(booking => {
                    rows.push([
                        booking.date || '',
                        booking.time || '',
                        booking.name || '',
                        booking.model || '',
                        booking.Plat_Nomor || '',
                        booking.service || '',
                        booking.Keluhan || '',
                        booking.phone || ''
                    ]);
                });
                
                const tsvContent = rows.map(row => row.join('\t')).join('\n');
                
                try {
                    await navigator.clipboard.writeText(tsvContent);
                    
                    window.open('https://sheets.google.com/create', '_blank');
                    
                    const message = hasActiveFilter 
                        ? ` Data filter berhasil disalin!\n\n ${bookingsToExport.length} booking(s)\n Google Sheets dibuka otomatis\n\n Langkah selanjutnya:\n1. Klik cell A1 di Google Sheets\n2. Tekan Ctrl+V (Windows) atau Cmd+V (Mac)\n3. Data akan tersusun rapi dalam kolom!\n4. Klik File > Save untuk menyimpan\n\n Selesai! Data sudah ada di spreadsheet.`
                        : ` Semua data berhasil disalin!\n\n ${bookingsToExport.length} booking(s)\n Google Sheets dibuka otomatis\n\n Langkah selanjutnya:\n1. Klik cell A1 di Google Sheets\n2. Tekan Ctrl+V (Windows) atau Cmd+V (Mac)\n3. Data akan tersusun rapi dalam kolom!\n4. Klik File > Save untuk menyimpan\n\n Selesai! Data sudah ada di spreadsheet.`;
                    
                    setTimeout(() => {
                        alert(message);
                    }, 800);
                    
                } catch (clipboardError) {
                    console.error("Clipboard error:", clipboardError);
                    alert("Gagal menyalin data ke clipboard.\n\nPastikan browser Anda mengizinkan akses clipboard.\n\nSilakan coba lagi atau gunakan Export Excel sebagai alternatif.");
                }
                
            } catch (error) {
                console.error("Export to Google Sheets error:", error);
                alert("Gagal mengekspor data. Silakan coba lagi.");
            }
        };

        window.adminLogout = function() {
            isAdminLoggedIn = false;
            localStorage.removeItem('adminLoggedIn');
            localStorage.removeItem('adminLoginTime');
            sessionStorage.removeItem('currentPage');
            document.querySelectorAll('.hero, .facilities, .booking, .about, .contact').forEach(el => el.style.display = 'block');
            document.getElementById('adminPanel').classList.remove('show');
            alert('Logout berhasil!');
        };

        function checkAdminSession() {
            const loggedIn = localStorage.getItem('adminLoggedIn');
            const loginTime = localStorage.getItem('adminLoginTime');
            
            if (loggedIn === 'true' && loginTime) {
                const currentTime = new Date().getTime();
                const sessionDuration = 24 * 60 * 60 * 1000;
                
                if (currentTime - parseInt(loginTime) < sessionDuration) {
                    return true;
                }
            }
            return false;
        }

        function activateAdminPanel() {
            isAdminLoggedIn = true;
            document.querySelectorAll('.hero, .facilities, .booking, .about, .contact').forEach(el => el.style.display = 'none');
            document.getElementById('cekService').classList.remove('show');
            document.getElementById('adminPanel').classList.add('show');
            sessionStorage.setItem('currentPage', 'adminPanel');
            window.displayBookings();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        document.getElementById('loginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;
            
            if (password === 'cheryarta01') {
                isAdminLoggedIn = true;
                localStorage.setItem('adminLoggedIn', 'true');
                localStorage.setItem('adminLoginTime', new Date().getTime().toString());
                closeLoginModal();
                activateAdminPanel();
                alert('Login berhasil!');
            } else {
                alert('Password salah!');
            }
        });

        document.getElementById('editForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            if (!editingBookingId) {
                alert('Error: No booking selected');
                return;
            }

            const updatedBooking = {
                name: document.getElementById('editName').value.trim(),
                Plat_Nomor: document.getElementById('editPlat').value.trim().toUpperCase(),
                phone: document.getElementById('editPhone').value.trim(),
                model: document.getElementById('editModel').value.trim(),
                service: document.getElementById('editService').value,
                date: document.getElementById('editDate').value,
                time: document.getElementById('editTime').value,
                Keluhan: document.getElementById('editKeluhan').value.trim(),
                status: document.getElementById('editStatus').value
            };

            try {
                await set(ref(db, "bookings/" + editingBookingId), updatedBooking);
                alert('Booking berhasil diupdate!');
                closeEditModal();
                window.displayBookings();
            } catch (error) {
                console.error("Error updating booking:", error);
                alert('Gagal mengupdate booking. Silakan coba lagi.');
            }
        });

        window.addEventListener('scroll', () => {
            const header = document.getElementById('header');
            if (window.scrollY > 100) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            initSliderIndicators();
            initTouchSupport();
            initImagePreviewSwipe();
            const tomorrow = new Date();
tomorrow.setDate(tomorrow.getDate() + 1);
const minDate = tomorrow.toISOString().split('T')[0];
document.getElementById('date').setAttribute('min', minDate);
            
            if (checkAdminSession()) {
                activateAdminPanel();
            } else {
                const currentPage = sessionStorage.getItem('currentPage');
                if (currentPage === 'cekService') {
                    showCekService();
                }
            }

            const dropdown = document.querySelector("#serviceDropdown");
            const trigger = dropdown.querySelector(".custom-select-trigger");
            const options = dropdown.querySelectorAll(".custom-option");
            const hiddenInput = document.getElementById("service");
            
            trigger.addEventListener("click", (e) => {
                e.stopPropagation();
                dropdown.classList.toggle("open");
            });
            
            options.forEach(option => {
                option.addEventListener("click", () => {
                    options.forEach(o => o.classList.remove("selected"));
                    option.classList.add("selected");
                    trigger.textContent = option.textContent;
                    hiddenInput.value = option.getAttribute("data-value");
                    dropdown.classList.remove("open");
                });
            });
            
            document.addEventListener("click", (e) => {
                if (!dropdown.contains(e.target)) dropdown.classList.remove("open");
            });

            const editDropdown = document.querySelector("#editServiceDropdown");
            const editTrigger = editDropdown.querySelector(".custom-select-trigger");
            const editOptions = editDropdown.querySelectorAll(".custom-option");
            const editHiddenInput = document.getElementById("editService");
            
            editTrigger.addEventListener("click", (e) => {
                e.stopPropagation();
                editDropdown.classList.toggle("open");
            });
            
            editOptions.forEach(option => {
                option.addEventListener("click", () => {
                    editOptions.forEach(o => o.classList.remove("selected"));
                    option.classList.add("selected");
                    editTrigger.textContent = option.textContent;
                    editHiddenInput.value = option.getAttribute("data-value");
                    editDropdown.classList.remove("open");
                });
            });
            
            document.addEventListener("click", (e) => {
                if (!editDropdown.contains(e.target)) editDropdown.classList.remove("open");
            });
        });
    </script>
    <script>
    const dateInput = document.getElementById("date");

    // Set min date = hari ini (opsional tapi disarankan)
    const today = new Date().toISOString().split("T")[0];
    dateInput.min = today;

    dateInput.addEventListener("input", function () {
        const selectedDate = new Date(this.value);
        const day = selectedDate.getDay(); // 0 = Minggu

        if (day === 0) {
            alert("Booking tidak tersedia pada hari Minggu. Silakan pilih hari lain.");
            this.value = ""; // reset tanggal
        }
    });
</script>
</body>
</html>
            
